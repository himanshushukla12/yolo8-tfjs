{"ast":null,"code":"import React,{useState,useEffect,useRef}from\"react\";import*as tf from\"@tensorflow/tfjs\";import\"@tensorflow/tfjs-backend-webgl\";// set backend to webgl\nimport Loader from\"./components/loader\";import ButtonHandler from\"./components/btn-handler\";import{detect,detectVideo}from\"./utils/detect\";import\"./style/App.css\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";const App=()=>{const[loading,setLoading]=useState({loading:true,progress:0});// loading state\nconst[model,setModel]=useState({net:null,inputShape:[1,0,0,3]});// init model & input shape\n// references\nconst imageRef=useRef(null);const cameraRef=useRef(null);const videoRef=useRef(null);const canvasRef=useRef(null);// model configs\nconst modelName=\"yolov8n\";useEffect(()=>{tf.ready().then(async()=>{const yolov8=await tf.loadGraphModel(\"\".concat(window.location.href,\"/\").concat(modelName,\"_web_model/model.json\"),{onProgress:fractions=>{setLoading({loading:true,progress:fractions});// set loading fractions\n}});// load model\n// warming up model\nconst dummyInput=tf.ones(yolov8.inputs[0].shape);const warmupResults=yolov8.execute(dummyInput);setLoading({loading:false,progress:1});setModel({net:yolov8,inputShape:yolov8.inputs[0].shape});// set model & input shape\ntf.dispose([warmupResults,dummyInput]);// cleanup memory\n});},[]);return/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[loading.loading&&/*#__PURE__*/_jsxs(Loader,{children:[\"Loading model... \",(loading.progress*100).toFixed(2),\"%\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"header\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\uD83D\\uDCF7 YOLOv8 Live Detection App\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"YOLOv8 live detection application on browser powered by \",/*#__PURE__*/_jsx(\"code\",{children:\"tensorflow.js\"})]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Serving : \",/*#__PURE__*/_jsx(\"code\",{className:\"code\",children:modelName})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"content\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"#\",ref:imageRef,onLoad:()=>detect(imageRef.current,model,canvasRef.current)}),/*#__PURE__*/_jsx(\"video\",{autoPlay:true,muted:true,ref:cameraRef,onPlay:()=>detectVideo(cameraRef.current,model,canvasRef.current)}),/*#__PURE__*/_jsx(\"video\",{autoPlay:true,muted:true,ref:videoRef,onPlay:()=>detectVideo(videoRef.current,model,canvasRef.current)}),/*#__PURE__*/_jsx(\"canvas\",{width:model.inputShape[1],height:model.inputShape[2],ref:canvasRef})]}),/*#__PURE__*/_jsx(ButtonHandler,{imageRef:imageRef,cameraRef:cameraRef,videoRef:videoRef})]});};export default App;","map":{"version":3,"names":["React","useState","useEffect","useRef","tf","Loader","ButtonHandler","detect","detectVideo","jsxs","_jsxs","jsx","_jsx","App","loading","setLoading","progress","model","setModel","net","inputShape","imageRef","cameraRef","videoRef","canvasRef","modelName","ready","then","yolov8","loadGraphModel","concat","window","location","href","onProgress","fractions","dummyInput","ones","inputs","shape","warmupResults","execute","dispose","className","children","toFixed","src","ref","onLoad","current","autoPlay","muted","onPlay","width","height"],"sources":["E:/office work/hositngYOLOgithub/yolov8-tfjs/src/App.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\r\nimport * as tf from \"@tensorflow/tfjs\";\r\nimport \"@tensorflow/tfjs-backend-webgl\"; // set backend to webgl\r\nimport Loader from \"./components/loader\";\r\nimport ButtonHandler from \"./components/btn-handler\";\r\nimport { detect, detectVideo } from \"./utils/detect\";\r\nimport \"./style/App.css\";\r\n\r\nconst App = () => {\r\n  const [loading, setLoading] = useState({ loading: true, progress: 0 }); // loading state\r\n  const [model, setModel] = useState({\r\n    net: null,\r\n    inputShape: [1, 0, 0, 3],\r\n  }); // init model & input shape\r\n\r\n  // references\r\n  const imageRef = useRef(null);\r\n  const cameraRef = useRef(null);\r\n  const videoRef = useRef(null);\r\n  const canvasRef = useRef(null);\r\n\r\n  // model configs\r\n  const modelName = \"yolov8n\";\r\n\r\n  useEffect(() => {\r\n    tf.ready().then(async () => {\r\n      const yolov8 = await tf.loadGraphModel(\r\n        `${window.location.href}/${modelName}_web_model/model.json`,\r\n        {\r\n          onProgress: (fractions) => {\r\n            setLoading({ loading: true, progress: fractions }); // set loading fractions\r\n          },\r\n        }\r\n      ); // load model\r\n\r\n      // warming up model\r\n      const dummyInput = tf.ones(yolov8.inputs[0].shape);\r\n      const warmupResults = yolov8.execute(dummyInput);\r\n\r\n      setLoading({ loading: false, progress: 1 });\r\n      setModel({\r\n        net: yolov8,\r\n        inputShape: yolov8.inputs[0].shape,\r\n      }); // set model & input shape\r\n\r\n      tf.dispose([warmupResults, dummyInput]); // cleanup memory\r\n    });\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      {loading.loading && <Loader>Loading model... {(loading.progress * 100).toFixed(2)}%</Loader>}\r\n      <div className=\"header\">\r\n        <h1>ðŸ“· YOLOv8 Live Detection App</h1>\r\n        <p>\r\n          YOLOv8 live detection application on browser powered by <code>tensorflow.js</code>\r\n        </p>\r\n        <p>\r\n          Serving : <code className=\"code\">{modelName}</code>\r\n        </p>\r\n      </div>\r\n\r\n      <div className=\"content\">\r\n        <img\r\n          src=\"#\"\r\n          ref={imageRef}\r\n          onLoad={() => detect(imageRef.current, model, canvasRef.current)}\r\n        />\r\n        <video\r\n          autoPlay\r\n          muted\r\n          ref={cameraRef}\r\n          onPlay={() => detectVideo(cameraRef.current, model, canvasRef.current)}\r\n        />\r\n        <video\r\n          autoPlay\r\n          muted\r\n          ref={videoRef}\r\n          onPlay={() => detectVideo(videoRef.current, model, canvasRef.current)}\r\n        />\r\n        <canvas width={model.inputShape[1]} height={model.inputShape[2]} ref={canvasRef} />\r\n      </div>\r\n\r\n      <ButtonHandler imageRef={imageRef} cameraRef={cameraRef} videoRef={videoRef} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default App;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}